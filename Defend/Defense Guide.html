<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ›¡ï¸ Security Defense Guide - OpenID Connect</title>
    <link rel="stylesheet" href="defense.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="shield-icon">ğŸ›¡ï¸</div>
            <h1>SECURITY DEFENSE GUIDE</h1>
            <p class="subtitle">HÆ°á»›ng dáº«n phÃ²ng chá»‘ng cÃ¡c cuá»™c táº¥n cÃ´ng OpenID Connect</p>
        </div>

        <div class="security-score">
            <h2>ğŸ¯ Security Score</h2>
            <div class="score-display">
                <div class="score-circle">
                    <span id="scoreValue">0</span>
                    <span class="score-max">/100</span>
                </div>
                <div class="score-status" id="scoreStatus">Vulnerable</div>
            </div>
            <div class="score-breakdown">
                <div class="score-item">
                    <span>XSS Protection</span>
                    <span id="xssScore">0/20</span>
                </div>
                <div class="score-item">
                    <span>CSRF Protection</span>
                    <span id="csrfScore">0/15</span>
                </div>
                <div class="score-item">
                    <span>Phishing Prevention</span>
                    <span id="phishingScore">0/15</span>
                </div>
                <div class="score-item">
                    <span>Token Security</span>
                    <span id="tokenScore">0/25</span>
                </div>
                <div class="score-item">
                    <span>Code Protection</span>
                    <span id="codeScore">0/15</span>
                </div>
                <div class="score-item">
                    <span>Session Security</span>
                    <span id="sessionScore">0/10</span>
                </div>
            </div>
        </div>

        <div class="defense-grid">
            <!-- Defense #1: XSS Protection -->
            <div class="defense-card">
                <div class="defense-header">
                    <h3>ğŸ›¡ï¸ Defense #1: XSS Protection</h3>
                    <span class="status-badge badge-danger">Critical</span>
                </div>
                <p class="defense-desc">NgÄƒn cháº·n Cross-Site Scripting Ä‘á»ƒ báº£o vá»‡ tokens khá»i bá»‹ Ä‘Ã¡nh cáº¯p.</p>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="xss" data-points="5">
                        <span>âœ… Input Sanitization & Validation</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="xss" data-points="5">
                        <span>âœ… Content Security Policy (CSP)</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="xss" data-points="5">
                        <span>âœ… HttpOnly Cookies</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="xss" data-points="5">
                        <span>âœ… Output Encoding</span>
                    </label>
                </div>

                <button class="btn btn-info" onclick="showXSSDefense()">ğŸ“– Xem HÆ°á»›ng Dáº«n</button>
                <button class="btn btn-success" onclick="implementXSSDefense()">ğŸ”§ Triá»ƒn Khai</button>
            </div>

            <!-- Defense #2: CSRF Protection -->
            <div class="defense-card">
                <div class="defense-header">
                    <h3>ğŸ›¡ï¸ Defense #2: CSRF Protection</h3>
                    <span class="status-badge badge-warning">High</span>
                </div>
                <p class="defense-desc">NgÄƒn cháº·n Cross-Site Request Forgery vá»›i token validation.</p>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="csrf" data-points="5">
                        <span>âœ… CSRF Tokens</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="csrf" data-points="5">
                        <span>âœ… SameSite Cookies</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="csrf" data-points="5">
                        <span>âœ… Origin/Referer Validation</span>
                    </label>
                </div>

                <button class="btn btn-info" onclick="showCSRFDefense()">ğŸ“– Xem HÆ°á»›ng Dáº«n</button>
                <button class="btn btn-success" onclick="implementCSRFDefense()">ğŸ”§ Triá»ƒn Khai</button>
            </div>

            <!-- Defense #3: Phishing Prevention -->
            <div class="defense-card">
                <div class="defense-header">
                    <h3>ğŸ›¡ï¸ Defense #3: Phishing Prevention</h3>
                    <span class="status-badge badge-warning">High</span>
                </div>
                <p class="defense-desc">Báº£o vá»‡ ngÆ°á»i dÃ¹ng khá»i trang web giáº£ máº¡o vÃ  Ä‘Ã¡nh cáº¯p credentials.</p>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="phishing" data-points="4">
                        <span>âœ… HTTPS Everywhere</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="phishing" data-points="4">
                        <span>âœ… Multi-Factor Authentication</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="phishing" data-points="4">
                        <span>âœ… Security Awareness Training</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="phishing" data-points="3">
                        <span>âœ… FIDO2/WebAuthn</span>
                    </label>
                </div>

                <button class="btn btn-info" onclick="showPhishingDefense()">ğŸ“– Xem HÆ°á»›ng Dáº«n</button>
                <button class="btn btn-success" onclick="implementPhishingDefense()">ğŸ”§ Triá»ƒn Khai</button>
            </div>

            <!-- Defense #4: Token Security -->
            <div class="defense-card">
                <div class="defense-header">
                    <h3>ğŸ›¡ï¸ Defense #4: Token Security</h3>
                    <span class="status-badge badge-danger">Critical</span>
                </div>
                <p class="defense-desc">Báº£o vá»‡ tokens khá»i replay attacks vÃ  unauthorized access.</p>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="token" data-points="5">
                        <span>âœ… Short Token Lifetime</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="token" data-points="5">
                        <span>âœ… Token Binding</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="token" data-points="5">
                        <span>âœ… Refresh Token Rotation</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="token" data-points="5">
                        <span>âœ… JWT Validation</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="token" data-points="5">
                        <span>âœ… Anomaly Detection</span>
                    </label>
                </div>

                <button class="btn btn-info" onclick="showTokenDefense()">ğŸ“– Xem HÆ°á»›ng Dáº«n</button>
                <button class="btn btn-success" onclick="implementTokenDefense()">ğŸ”§ Triá»ƒn Khai</button>
            </div>

            <!-- Defense #5: Code Protection -->
            <div class="defense-card">
                <div class="defense-header">
                    <h3>ğŸ›¡ï¸ Defense #5: Authorization Code Protection</h3>
                    <span class="status-badge badge-danger">Critical</span>
                </div>
                <p class="defense-desc">NgÄƒn cháº·n code interception vá»›i PKCE vÃ  strict validation.</p>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="code" data-points="5">
                        <span>âœ… PKCE Implementation</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="code" data-points="5">
                        <span>âœ… Redirect URI Whitelist</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="code" data-points="5">
                        <span>âœ… One-Time Code Usage</span>
                    </label>
                </div>

                <button class="btn btn-info" onclick="showCodeDefense()">ğŸ“– Xem HÆ°á»›ng Dáº«n</button>
                <button class="btn btn-success" onclick="implementCodeDefense()">ğŸ”§ Triá»ƒn Khai</button>
            </div>

            <!-- Defense #6: Session Security -->
            <div class="defense-card">
                <div class="defense-header">
                    <h3>ğŸ›¡ï¸ Defense #6: Session Security</h3>
                    <span class="status-badge badge-warning">High</span>
                </div>
                <p class="defense-desc">Báº£o vá»‡ session khá»i hijacking vá»›i monitoring vÃ  binding.</p>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="session" data-points="3">
                        <span>âœ… Device Fingerprinting</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="session" data-points="3">
                        <span>âœ… IP Validation</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" data-defense="session" data-points="4">
                        <span>âœ… Session Monitoring</span>
                    </label>
                </div>

                <button class="btn btn-info" onclick="showSessionDefense()">ğŸ“– Xem HÆ°á»›ng Dáº«n</button>
                <button class="btn btn-success" onclick="implementSessionDefense()">ğŸ”§ Triá»ƒn Khai</button>
            </div>
        </div>

        <!-- Best Practices Section -->
        <div class="best-practices">
            <h2>ğŸ† Security Best Practices</h2>
            <div class="practice-grid">
                <div class="practice-item">
                    <div class="practice-icon">ğŸ”’</div>
                    <h4>Always Use HTTPS</h4>
                    <p>Encrypt all communications with TLS 1.3</p>
                </div>
                <div class="practice-item">
                    <div class="practice-icon">ğŸ”‘</div>
                    <h4>Strong Authentication</h4>
                    <p>Implement MFA and passwordless auth</p>
                </div>
                <div class="practice-item">
                    <div class="practice-icon">ğŸ“Š</div>
                    <h4>Security Monitoring</h4>
                    <p>Log and analyze all security events</p>
                </div>
                <div class="practice-item">
                    <div class="practice-icon">ğŸ”„</div>
                    <h4>Regular Updates</h4>
                    <p>Keep all dependencies up-to-date</p>
                </div>
                <div class="practice-item">
                    <div class="practice-icon">ğŸ§ª</div>
                    <h4>Security Testing</h4>
                    <p>Regular penetration testing and audits</p>
                </div>
                <div class="practice-item">
                    <div class="practice-icon">ğŸ“š</div>
                    <h4>User Education</h4>
                    <p>Train users on security awareness</p>
                </div>
            </div>
        </div>

        <!-- Implementation Guide Modal -->
        <div id="guideModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal()">&times;</span>
                <div id="guideContent"></div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="downloadSecurityChecklist()">
                ğŸ“¥ Download Security Checklist
            </button>
            <button class="btn btn-secondary" onclick="generateReport()">
                ğŸ“Š Generate Security Report
            </button>
            <button class="btn btn-danger" onclick="resetProgress()">
                ğŸ”„ Reset Progress
            </button>
        </div>
    </div>

    <script src="defense.js"></script>
</body>
</html>